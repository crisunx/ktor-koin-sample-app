# ktor-koin-sample-app
> Ktor is a web application framework written in Kotlin that utilizes Coroutines to provide the fully asynchronous, non-blocking behavior.
 Shows usage of  ktor to create a simple API to store simple todo list.

[![ktlint](https://img.shields.io/badge/code%20style-%E2%9D%A4-FF4081.svg)](https://ktlint.github.io/)
![Kotlin](https://img.shields.io/badge/kotlin-v1.3.72-blue?style=flat&logo=data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE5LjEuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHZpZXdCb3g9IjAgMCA2MCA2MCIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNjAgNjA7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPGc+CgoJCTxsaW5lYXJHcmFkaWVudCBpZD0iWE1MSURfM18iIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4MT0iMTUuOTU5NCIgeTE9Ii0xMy4wMTQzIiB4Mj0iNDQuMzA2OCIgeTI9IjE1LjMzMzIiIGdyYWRpZW50VHJhbnNmb3JtPSJtYXRyaXgoMSAwIDAgLTEgMCA2MSkiPgoJCTxzdG9wICBvZmZzZXQ9IjkuNjc3MDAwZS0wMiIgc3R5bGU9InN0b3AtY29sb3I6IzAwOTVENSIvPgoJCTxzdG9wICBvZmZzZXQ9IjAuMzAwNyIgc3R5bGU9InN0b3AtY29sb3I6IzIzOEFEOSIvPgoJCTxzdG9wICBvZmZzZXQ9IjAuNjIxMSIgc3R5bGU9InN0b3AtY29sb3I6IzU1N0JERSIvPgoJCTxzdG9wICBvZmZzZXQ9IjAuODY0MyIgc3R5bGU9InN0b3AtY29sb3I6Izc0NzJFMiIvPgoJCTxzdG9wICBvZmZzZXQ9IjEiIHN0eWxlPSJzdG9wLWNvbG9yOiM4MDZFRTMiLz4KCTwvbGluZWFyR3JhZGllbnQ+Cgk8cG9seWdvbiBpZD0iWE1MSURfMl8iIHN0eWxlPSJmaWxsOnVybCgjWE1MSURfM18pOyIgcG9pbnRzPSIwLDYwIDMwLjEsMjkuOSA2MCw2MCAJIi8+CgoJCTxsaW5lYXJHcmFkaWVudCBpZD0iU1ZHSURfMV8iIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4MT0iNC4yMDkyIiB5MT0iNDguOTQwOSIgeDI9IjIwLjY3MzQiIHkyPSI2NS40MDUiIGdyYWRpZW50VHJhbnNmb3JtPSJtYXRyaXgoMSAwIDAgLTEgMCA2MSkiPgoJCTxzdG9wICBvZmZzZXQ9IjAuMTE4MyIgc3R5bGU9InN0b3AtY29sb3I6IzAwOTVENSIvPgoJCTxzdG9wICBvZmZzZXQ9IjAuNDE3OCIgc3R5bGU9InN0b3AtY29sb3I6IzNDODNEQyIvPgoJCTxzdG9wICBvZmZzZXQ9IjAuNjk2MiIgc3R5bGU9InN0b3AtY29sb3I6IzZENzRFMSIvPgoJCTxzdG9wICBvZmZzZXQ9IjAuODMzMyIgc3R5bGU9InN0b3AtY29sb3I6IzgwNkVFMyIvPgoJPC9saW5lYXJHcmFkaWVudD4KCTxwb2x5Z29uIHN0eWxlPSJmaWxsOnVybCgjU1ZHSURfMV8pOyIgcG9pbnRzPSIwLDAgMzAuMSwwIDAsMzIuNSAJIi8+CgoJCTxsaW5lYXJHcmFkaWVudCBpZD0iU1ZHSURfMl8iIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4MT0iLTEwLjEwMTciIHkxPSI1LjgzNjIiIHgyPSI0NS43MzE1IiB5Mj0iNjEuNjY5NCIgZ3JhZGllbnRUcmFuc2Zvcm09Im1hdHJpeCgxIDAgMCAtMSAwIDYxKSI+CgkJPHN0b3AgIG9mZnNldD0iMC4xMDc1IiBzdHlsZT0ic3RvcC1jb2xvcjojQzc1N0JDIi8+CgkJPHN0b3AgIG9mZnNldD0iMC4yMTM4IiBzdHlsZT0ic3RvcC1jb2xvcjojRDA2MDlBIi8+CgkJPHN0b3AgIG9mZnNldD0iMC40MjU0IiBzdHlsZT0ic3RvcC1jb2xvcjojRTE3MjVDIi8+CgkJPHN0b3AgIG9mZnNldD0iMC42MDQ4IiBzdHlsZT0ic3RvcC1jb2xvcjojRUU3RTJGIi8+CgkJPHN0b3AgIG9mZnNldD0iMC43NDMiIHN0eWxlPSJzdG9wLWNvbG9yOiNGNTg2MTMiLz4KCQk8c3RvcCAgb2Zmc2V0PSIwLjgyMzIiIHN0eWxlPSJzdG9wLWNvbG9yOiNGODg5MDkiLz4KCTwvbGluZWFyR3JhZGllbnQ+Cgk8cG9seWdvbiBzdHlsZT0iZmlsbDp1cmwoI1NWR0lEXzJfKTsiIHBvaW50cz0iMzAuMSwwIDAsMzEuNyAwLDYwIDMwLjEsMjkuOSA2MCwwIAkiLz4KPC9nPgo8L3N2Zz4K)
![ktor](https://img.shields.io/badge/ktor-v1.3.2-orange?style=flat&logo=data:image/png;base64,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)
![branch](https://img.shields.io/badge/branch-master-green.svg)

## Build

Building the project
```sh
./gradlew clean && ./gradlew build
```

Compiling the project and generating a docker image
```sh
./gradlew clean && ./gradlew build && docker build --no-cache -t crisun/ktor-koin-sample-app .
```

Compiling the project and generating a docker image with docker-compose
```sh
./gradlew clean && ./gradlew build && docker-compose build
```

## Start

Using docker-compose:
```sh
docker-compose up
```

Using docker:
```sh
docker run --rm -it -p 8080:8080 crisun/ktor-koin-sample-app
```

Running manually:
```sh
java -jar ktor-koin-sample-app-1.0.0-all.jar
```

## Example of use

Start the application and call the operations:

Login to obtain jwt token:
```sh
curl -i -XPOST -H "Content-type: application/json" "http://localhost:8080/user/login" -d '{"username":"crisun","password":"r4e3w2q1"}'
```
List all tasks:
```sh
curl -i -H "Authorization: Bearer $TOKEN" "http://localhost:8080/todos"
```
Query a task:
```sh
curl -i -H "Authorization: Bearer $TOKEN" "http://localhost:8080/todo/1"
```
Insert task:
```sh
curl -i -XPOST -H "Authorization: Bearer $TOKEN" -H "Content-Type: application/json" "http://localhost:8080/todo" -d '{"title":"Task 1","description":"Do the homework"}'
```
Update task:
```sh
curl -i -XPUT -H "Authorization: Bearer $TOKEN" -H "Content-Type: application/json" "http://localhost:8080/todo/1" -d '{"title":"Task 1","description":"Do the homework and clean the house"}'
```
Delete task:
```sh
curl -i -XDELETE -H "Authorization: Bearer $TOKEN" -H "Content-Type: application/json" "http://localhost:8080/todo/1"
```
Health check:
```sh
curl -i "http://localhost:8080/health"
```

## Libraries
Koin: https://insert-koin.io

flywaydb: https://flywaydb.org

Logback: http://logback.qos.ch

Spring Jdbc: https://spring.io

H2 Database: https://www.h2database.com

HikariCP: https://github.com/brettwooldridge/HikariCP

Kotlin Logging: https://github.com/MicroUtils/kotlin-logging

Ktor flyway feature: https://github.com/viartemev/ktor-flyway-feature

Ktor JWT feature: https://ktor.io/servers/features/authentication/jwt.html

